"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _deepmerge=_interopRequireDefault(require("deepmerge")),_electronStore=_interopRequireDefault(require("electron-store"));function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function PersistedState(a,b){var c=this,d="test";this.loadOptions=function(){a.storage||(a.storage=c.createStorage()),a.storageKey||(a.storageKey="state"),c.whitelist=c.loadFilter(a.whitelist,"whitelist"),c.blacklist=c.loadFilter(a.blacklist,"blacklist")},this.createStorage=function(){return new _electronStore.default({name:a.storageName||"vuex"})},this.getState=function(){return a.storage.get(a.storageKey)},this.setState=function(b){a.storage.set(a.storageKey,b)},this.loadFilter=function(a,b){if(!a)return null;if(a instanceof Array)return c.filterInArray(a);if("function"==typeof a)return a;throw new Error("[Vuex Electron] Filter \"".concat(b,"\" should be Array or Function. Please, read the docs."))},this.filterInArray=function(a){return function(b){return a.includes(b.type)}},this.checkStorage=function(){try{a.storage.set(d,d),a.storage.get(d),a.storage.delete(d)}catch(a){throw new Error("[Vuex Electron] Storage is not valid. Please, read the docs.")}},this.loadInitialState=function(){var d=c.getState(a.storage,a.storageKey);if(d){var e=(0,_deepmerge.default)(b.state,d);b.replaceState(e)}},this.subscribeOnChanges=function(){b.subscribe(function(a,b){c.blacklist&&c.blacklist(a)||c.whitelist&&!c.whitelist(a)||c.setState(b)})}}var _default=function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return function(b){var c=new PersistedState(a,b);c.loadOptions(),c.checkStorage(),c.loadInitialState(),c.subscribeOnChanges()}};exports.default=_default,module.exports=exports["default"];