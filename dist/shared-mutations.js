"use strict";var _electron=require("electron");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;function SharedMutations(a,b){var c=this,d="vuex-mutations-connect",e="vuex-mutations-notify-main",f="vuex-mutations-notify-renderers";this.loadOptions=function(){a.type||(a.type="renderer"===process.type?"renderer":"main"),a.ipcMain||(a.ipcMain=_electron.ipcMain),a.ipcRenderer||(a.ipcRenderer=_electron.ipcRenderer)},this.connect=function(b){a.ipcRenderer.send(d,b)},this.onConnect=function(b){a.ipcMain.on(d,b)},this.notifyMain=function(b){a.ipcRenderer.send(e,b)},this.onNotifyMain=function(b){a.ipcMain.on(e,b)},this.notifyRenderers=function(a,b){Object.keys(a).forEach(function(c){a[c].send(f,b)})},this.onNotifyRenderers=function(b){a.ipcRenderer.on(f,b)},this.rendererProcessLogic=function(){c.connect(),b.originalCommit=b.commit,b.originalDispatch=b.dispatch,b.commit=function(){throw new Error("[Vuex Electron] Please, don't use direct commit's, use dispatch instead of this.")},b.dispatch=function(a,b){c.notifyMain({type:a,payload:b})},c.onNotifyRenderers(function(a,c){var d=c.type,e=c.payload;b.originalCommit(d,e)})},this.mainProcessLogic=function(){var a={};c.onConnect(function(b){a[b.sender.id]=b.sender,b.sender.on("destroyed",function(){delete a[b.sender.id]})}),c.onNotifyMain(function(a,c){var d=c.type,e=c.payload;b.dispatch(d,e)}),b.subscribe(function(b){var d=b.type,e=b.payload;c.notifyRenderers(a,{type:d,payload:e})})},this.activatePlugin=function(){switch(a.type){case"renderer":c.rendererProcessLogic();break;case"main":c.mainProcessLogic();break;default:throw new Error("[Vuex Electron] Type should be \"renderer\" or \"main\".");}}}var _default=function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return function(b){var c=new SharedMutations(a,b);c.loadOptions(),c.activatePlugin()}};exports.default=_default,module.exports=exports["default"];